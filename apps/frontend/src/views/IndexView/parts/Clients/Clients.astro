---
import { getCollection } from 'astro:content'

import { ClientsCarousele } from './Clients.Carousele'
import { getImage } from 'astro:assets'

const clientsCollection = await getCollection('client')

const clientsLogosGlobs = import.meta.glob<ImageMetadata>('/src/assets/clients/**', { eager: true, import: 'default' })

const clientLogos = await Promise.all(
  clientsCollection.map(async (entry) => {
    const {
      data: { logo },
    } = entry
    const optimizedImage = await getImage({ src: clientsLogosGlobs[logo] })
    return optimizedImage.src
  }),
)
---

<section class="clients">
  <h3 class="clients__title">Tworzyli≈õmy projekty z...</h3>
  <div class="clients__content">
    <ClientsCarousele client:idle clientLogos={clientLogos} />
  </div>
</section>

<style>
  .clients {
    @apply py-[48px];
  }
  .clients__title {
    @apply text-center text-heading3 mb-[40px];
  }
  .clients__content {
    @apply flex items-center bg-extra-dark h-[188px];
  }
</style>
